export type Video = {
    title: string,
    thumbnail: string,
    videoId: string,
    description: string,
}

const temp_data = {
    "kind": "youtube#searchListResponse",
    "etag": "RRtDHduU2ClfTUu8Htiaex1D1Q8",
    "nextPageToken": "CAUQAA",
    "regionCode": "IN",
    "pageInfo": {
        "totalResults": 1000000,
        "resultsPerPage": 5
    },
    "items": [
        {
            "kind": "youtube#searchResult",
            "etag": "XkOkLiEg0_PX0dG_AjBmAdlg0zc",
            "id": {
                "kind": "youtube#video",
                "videoId": "kqtD5dpn9C8"
            },
            "snippet": {
                "publishedAt": "2020-09-16T13:00:20Z",
                "channelId": "UCWv7vMbMWH4-V0ZXdmDpPBA",
                "title": "Python for Beginners - Learn Coding with Python in 1 Hour",
                "description": "Learn Python basics in just 1 hour! Perfect for beginners interested in AI and coding. ⚡ Plus, get 6 months of PyCharm FREE with ...",
                "thumbnails": {
                    "default": {
                        "url": "https://i.ytimg.com/vi/kqtD5dpn9C8/default.jpg",
                        "width": 120,
                        "height": 90
                    },
                    "medium": {
                        "url": "https://i.ytimg.com/vi/kqtD5dpn9C8/mqdefault.jpg",
                        "width": 320,
                        "height": 180
                    },
                    "high": {
                        "url": "https://i.ytimg.com/vi/kqtD5dpn9C8/hqdefault.jpg",
                        "width": 480,
                        "height": 360
                    }
                },
                "channelTitle": "Programming with Mosh",
                "liveBroadcastContent": "none",
                "publishTime": "2020-09-16T13:00:20Z"
            }
        },
        {
            "kind": "youtube#searchResult",
            "etag": "9d225mTUG0M7gPKlfGAIF4Z94n8",
            "id": {
                "kind": "youtube#video",
                "videoId": "_uQrJ0TkZlc"
            },
            "snippet": {
                "publishedAt": "2019-02-18T15:00:08Z",
                "channelId": "UCWv7vMbMWH4-V0ZXdmDpPBA",
                "title": "Python Full Course for Beginners",
                "description": "Learn Python for AI, machine learning, and web development with this beginner-friendly course! Get 6 months of PyCharm ...",
                "thumbnails": {
                    "default": {
                        "url": "https://i.ytimg.com/vi/_uQrJ0TkZlc/default.jpg",
                        "width": 120,
                        "height": 90
                    },
                    "medium": {
                        "url": "https://i.ytimg.com/vi/_uQrJ0TkZlc/mqdefault.jpg",
                        "width": 320,
                        "height": 180
                    },
                    "high": {
                        "url": "https://i.ytimg.com/vi/_uQrJ0TkZlc/hqdefault.jpg",
                        "width": 480,
                        "height": 360
                    }
                },
                "channelTitle": "Programming with Mosh",
                "liveBroadcastContent": "none",
                "publishTime": "2019-02-18T15:00:08Z"
            }
        },
        {
            "kind": "youtube#searchResult",
            "etag": "-B5FHeP3yptljKCdQ0Ha8LPeOWI",
            "id": {
                "kind": "youtube#video",
                "videoId": "Sl4zqWLC9Xw"
            },
            "snippet": {
                "publishedAt": "2023-08-30T13:00:21Z",
                "channelId": "UCkcqmxjMXaBb0kDWqqSEU1g",
                "title": "Fastest way to learn Python #coding #python #programming",
                "description": "Fastest way to learn Python . ❣️ Save for later and subscribe for more! . For more content like this: ...",
                "thumbnails": {
                    "default": {
                        "url": "https://i.ytimg.com/vi/Sl4zqWLC9Xw/default.jpg",
                        "width": 120,
                        "height": 90
                    },
                    "medium": {
                        "url": "https://i.ytimg.com/vi/Sl4zqWLC9Xw/mqdefault.jpg",
                        "width": 320,
                        "height": 180
                    },
                    "high": {
                        "url": "https://i.ytimg.com/vi/Sl4zqWLC9Xw/hqdefault.jpg",
                        "width": 480,
                        "height": 360
                    }
                },
                "channelTitle": "Sahil & Sarra",
                "liveBroadcastContent": "none",
                "publishTime": "2023-08-30T13:00:21Z"
            }
        },
        {
            "kind": "youtube#searchResult",
            "etag": "9au4QBizk0FBEmVmrrLl4oLeeFU",
            "id": {
                "kind": "youtube#video",
                "videoId": "uWEIaF0PNGg"
            },
            "snippet": {
                "publishedAt": "2023-11-12T17:07:16Z",
                "channelId": "UCTrAO0TDCldnYUN3BkLmGcw",
                "title": "Python OPTIMIZATION Trick!!  #python #programming #coding",
                "description": "Join the Byte Club to practice your Python skills! ($2.99/mo): ...",
                "thumbnails": {
                    "default": {
                        "url": "https://i.ytimg.com/vi/uWEIaF0PNGg/default.jpg",
                        "width": 120,
                        "height": 90
                    },
                    "medium": {
                        "url": "https://i.ytimg.com/vi/uWEIaF0PNGg/mqdefault.jpg",
                        "width": 320,
                        "height": 180
                    },
                    "high": {
                        "url": "https://i.ytimg.com/vi/uWEIaF0PNGg/hqdefault.jpg",
                        "width": 480,
                        "height": 360
                    }
                },
                "channelTitle": "b001",
                "liveBroadcastContent": "none",
                "publishTime": "2023-11-12T17:07:16Z"
            }
        },
        {
            "kind": "youtube#searchResult",
            "etag": "arJ7JHoZEjvlGR5R-7rfWllfjJY",
            "id": {
                "kind": "youtube#video",
                "videoId": "g9fIWtSexLs"
            },
            "snippet": {
                "publishedAt": "2022-11-14T00:38:55Z",
                "channelId": "UCTrAO0TDCldnYUN3BkLmGcw",
                "title": "ALL Python Programmers Should Know This!! #python #programming #coding",
                "description": "Join the Byte Club to practice your Python skills! ($2.99/mo): ...",
                "thumbnails": {
                    "default": {
                        "url": "https://i.ytimg.com/vi/g9fIWtSexLs/default.jpg",
                        "width": 120,
                        "height": 90
                    },
                    "medium": {
                        "url": "https://i.ytimg.com/vi/g9fIWtSexLs/mqdefault.jpg",
                        "width": 320,
                        "height": 180
                    },
                    "high": {
                        "url": "https://i.ytimg.com/vi/g9fIWtSexLs/hqdefault.jpg",
                        "width": 480,
                        "height": 360
                    }
                },
                "channelTitle": "b001",
                "liveBroadcastContent": "none",
                "publishTime": "2022-11-14T00:38:55Z"
            }
        }
    ]
}
const fetch_all_videos = async(): Promise<Video[]> => {
    // const params = {
    //     "part": "snippet",
    //     "q": "Python Programming",
    //     "type": "video",
    //     "maxResults": 5,
    //     "key": `${import.meta.env.VITE_YOUTUBE_API_KEY}`
    // }.toString();

    let search_query = "Python+Programming"
    let maxResults = 5
    let key = import.meta.env.VITE_YOUTUBE_API_KEY;

    // let url = `https://www.googleapis.com/youtube/v3/search/?${params}`
    let url = `https://www.googleapis.com/youtube/v3/search?part=snippet&q=${search_query}&type=video&maxResults=${maxResults}&key=${key}`
    
    const response = await fetch(url);
    
    let data;
    
    if (response.status != 200){
        data = temp_data;
    }
    else {
        data = await response.json();
    }
    
    // Destructuring the data
    const all_videos: Video[] = data.items.map((item: any) => {
        const videoId = item.id.videoId;
        const title = item.snippet.title;
        const thumbnail = item.snippet.thumbnails.high.url;
        const description = item.snippet.description;

        return {videoId, title, thumbnail, description};
    });
    console.log("All videos ", all_videos);

    return all_videos
}

export default fetch_all_videos;
